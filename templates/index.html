<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Targetini - AI-Powered Professional Search</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --primary: #1a1a1a;
            --primary-glow: rgba(26, 26, 26, 0.3);
            --accent: #3a3a3a;
            --light: #f8f9fa;
            --card-bg: #ffffff;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.12);
            --gradient: linear-gradient(135deg, #1a1a1a 0%, #3a3a3a 100%);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fafafa;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .glow-effect {
            position: relative;
            z-index: 1;
        }
        
        .glow-effect::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            z-index: -1;
            opacity: 0;
            background: var(--gradient);
            transition: opacity 0.3s ease;
        }
        
        .glow-effect:hover::after {
            opacity: 0.1;
        }
        
        .btn-glow {
            background: var(--gradient);
            color: white;
            border: none;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(26, 26, 26, 0.2);
        }
        
        .btn-glow:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(26, 26, 26, 0.3);
        }
        
        .btn-glow:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .modern-card {
            background: var(--card-bg);
            border: 1px solid #eaeaea;
            border-radius: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow);
        }
        
        .modern-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-hover);
            border-color: #d4d4d4;
        }
        
        .search-input-glow {
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .search-input-glow:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(26, 26, 26, 0.1);
        }
        
        .pagination-btn {
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
        }
        
        .pagination-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background: #f8f9fa;
        }
        
        .match-badge {
            background: var(--gradient);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.3px;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .text-gradient {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .focus-ring:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(26, 26, 26, 0.1);
        }
        
        .pulse-dots:after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        .example-query {
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .example-query:hover {
            background: var(--primary) !important;
            color: white !important;
            border-color: var(--primary);
            transform: translateY(-1px);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        
        .status-processing {
            background: #f59e0b;
            animation: pulse 1.5s infinite;
        }
        
        .status-completed {
            background: #10b981;
        }
        
        .status-queued {
            background: #6b7280;
        }
        
        /* New styles for AI Agent features */
        .agent-message {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .agent-thinking {
            border-left: 3px solid #6366f1;
            background: linear-gradient(90deg, rgba(99, 102, 241, 0.05) 0%, rgba(99, 102, 241, 0.02) 100%);
        }
        
        .preference-badge {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
        }
        
        .reasoning-step {
            border-left: 2px solid #10b981;
            padding-left: 12px;
            margin-bottom: 8px;
        }
        
        .typing-indicator {
            display: inline-block;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background-color: #6b7280;
            animation: typing 1.4s infinite;
        }
        
        .typing-indicator:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-6px);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">

    <header class="glass-effect sticky top-0 z-50 border-b border-gray-100">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-3">
                    <div class="flex-shrink-0">
                        <img id="logo" src="/static/images/Targetini.png" alt="Targetini Logo" class="h-8 w-auto cursor-pointer">
                    </div>
                    <div class="hidden md:block">
                        <h1 class="text-lg font-bold tracking-tight">Target<span class="text-gradient">ini</span></h1>
                        <p class="text-xs text-gray-500">AI Recruiting Agents with LangGraph</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div id="agentStatusBadge" class="hidden md:flex items-center space-x-2 px-3 py-1.5 bg-gradient-to-r from-green-50 to-emerald-50 rounded-full border border-green-100">
                        <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        <span class="text-xs font-medium text-green-700">AI Agents Active</span>
                    </div>
                    <a href="https://www.linkedin.com/in/shubham-murar/" target="_blank" rel="noopener noreferrer" class="text-sm text-gray-600 hover:text-gray-900 transition-colors hidden sm:block">
                        Built by Shubham Murar
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8">

            <aside class="lg:col-span-3">
                <div class="modern-card p-6 sticky top-24 space-y-6 glass-effect">
                    <div class="text-center">
                        <div class="w-16 h-16 mx-auto mb-4 relative">
                            <div class="absolute inset-0 bg-gradient-to-br from-gray-900 to-gray-700 rounded-full opacity-10"></div>
                            <div class="relative w-full h-full flex items-center justify-center">
                                <i class="fas fa-robot text-gray-800 text-2xl"></i>
                            </div>
                        </div>
                        <h3 class="text-md font-bold mb-3 text-gray-900">AI Recruiting Agents</h3>
                        <div class="text-gray-600 text-sm space-y-3 text-left">
                            <div class="flex items-start">
                                <i class="fas fa-brain text-purple-500 mt-0.5 mr-2"></i>
                                <span><strong>Conversational Agent:</strong> Chat naturally to find candidates</span>
                            </div>
                            <div class="flex items-start">
                                <i class="fas fa-graduation-cap text-blue-500 mt-0.5 mr-2"></i>
                                <span><strong>Learning Agent:</strong> Adapts to your preferences over time</span>
                            </div>
                            <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-3 rounded-lg border border-purple-100 mt-3">
                                <p class="font-semibold text-purple-800 mb-1">ðŸ¤– Powered by LangGraph ðŸ¤–</p>
                                <p class="text-xs text-purple-600">Multi-agent orchestration with memory</p>
                            </div>
                        </div>
                    </div>
                    <div class="border-t border-gray-100"></div>
                    <div class="space-y-3">
                        <button id="chatWithAgentBtn" class="glow-effect flex items-center justify-center w-full btn-glow font-semibold py-3 px-4 rounded-xl text-sm group">
                            <i class="fas fa-comments text-lg mr-3 group-hover:scale-110 transition-transform"></i>
                            Chat with AI Agent
                        </button>
                        <button id="tryAdaptiveSearchBtn" class="btn-secondary flex items-center justify-center w-full font-semibold py-3 px-4 rounded-xl text-sm">
                            <i class="fas fa-magic mr-3"></i>
                            Try Adaptive Search
                        </button>
                    </div>
                    <div class="border-t border-gray-100"></div>
                    <div class="text-xs text-gray-600 space-y-3">
                        <p class="font-bold text-gray-800 text-sm"> Agent Capabilities:</p>
                        <ul class="space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-comment-dots text-purple-600 mt-0.5 mr-2"></i>
                                <span><strong>Natural conversation</strong> with memory</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-lightbulb text-yellow-600 mt-0.5 mr-2"></i>
                                <span><strong>Autonomous reasoning</strong> using LangGraph</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-chart-line text-green-600 mt-0.5 mr-2"></i>
                                <span><strong>Learns preferences</strong> from your feedback</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-search-plus text-blue-600 mt-0.5 mr-2"></i>
                                <span><strong>Pattern recognition</strong> in searches</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-tools text-gray-600 mt-0.5 mr-2"></i>
                                <span><strong>Tool usage</strong> for specialized tasks</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </aside>

            <div class="lg:col-span-9">
                <!-- AI Agent Status Card -->
                <div id="agentStatusCard" class="modern-card p-5 mb-6 bg-gradient-to-r from-gray-50 to-white border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <div class="relative">
                                <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center">
                                    <i class="fas fa-robot text-white text-lg"></i>
                                </div>
                                <div class="absolute -top-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center">
                                    <span class="text-white text-xs font-bold">2</span>
                                </div>
                            </div>
                            <div>
                                <h3 class="font-bold text-gray-900">AI Recruiting Agents Ready</h3>
                                <p class="text-sm text-gray-600">Powered by LangChain & LangGraph</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <button onclick="checkAgentStatus()" class="text-sm text-gray-600 hover:text-gray-900 flex items-center">
                                <i class="fas fa-sync-alt mr-2"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4" id="agentDetails">
                        <!-- Agent details will load here -->
                    </div>
                </div>

                <!-- AI Agent Chat Section -->
                <section id="agentChatSection" class="hidden modern-card p-6 sm:p-8 mb-6 glass-effect">
                    <div class="max-w-3xl">
                        <div class="mb-6 flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">
                                    <i class="fas fa-robot text-gradient mr-2"></i>
                                    Chat with AI Recruiting Agent
                                </h2>
                                <p class="text-gray-600">Have a natural conversation to find the perfect candidates.</p>
                            </div>
                            <button onclick="toggleAgentChat()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-4 mb-6 max-h-[400px] overflow-y-auto p-4 bg-gray-50 rounded-xl" id="agentChatMessages">
                            <div class="flex items-start space-x-3 agent-message">
                                <div class="flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-gray-900 to-gray-700 flex items-center justify-center">
                                    <i class="fas fa-robot text-white text-sm"></i>
                                </div>
                                <div class="bg-white p-4 rounded-xl flex-1 border border-gray-200">
                                    <p class="text-gray-700">Hi! I'm your AI Recruiting Agent powered by LangGraph. I can help you find professionals with natural language. Try asking:</p>
                                    <ul class="mt-2 space-y-1 text-sm text-gray-600">
                                        <li><i class="fas fa-chevron-right text-gray-400 mr-2"></i>"Find senior Python developers in San Francisco"</li>
                                        <li><i class="fas fa-chevron-right text-gray-400 mr-2"></i>"Show me marketing managers with startup experience"</li>
                                        <li><i class="fas fa-chevron-right text-gray-400 mr-2"></i>"I need AI researchers with PhDs"</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <input type="text" id="agentInput" 
                                   placeholder="Type your question for the agent..."
                                   class="search-input-glow flex-1 pl-4 pr-4 py-3 text-base bg-white rounded-xl focus:outline-none">
                            <button id="agentSendBtn" class="btn-glow font-semibold px-6 py-3 rounded-lg">
                                <i class="fas fa-paper-plane mr-2"></i>Send
                            </button>
                        </div>
                        
                        <div class="mt-4 flex flex-wrap gap-2">
                            <button class="agent-example-query text-sm bg-gray-100 text-gray-700 px-3 py-1.5 rounded-full hover:bg-gray-200 transition-colors">
                                <i class="fas fa-bolt text-yellow-500 mr-1"></i>Quick search
                            </button>
                            <button class="agent-example-query text-sm bg-gray-100 text-gray-700 px-3 py-1.5 rounded-full hover:bg-gray-200 transition-colors">
                                <i class="fas fa-filter text-blue-500 mr-1"></i>Refine results
                            </button>
                            <button class="agent-example-query text-sm bg-gray-100 text-gray-700 px-3 py-1.5 rounded-full hover:bg-gray-200 transition-colors">
                                <i class="fas fa-star text-purple-500 mr-1"></i>Learn preferences
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Main Search Section -->
                <section id="mainSearchSection" class="modern-card p-6 sm:p-8 mb-6 glass-effect">
                    <div class="max-w-3xl">
                        <div class="mb-6">
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">Stop Guessing, Start Finding</h2>
                            <p class="text-gray-600">Your AI-powered professional search assistant. Find exactly who you need with natural language - no more keyword guessing games.</p>
                        </div>
                        
                        <div class="relative mb-4">
                            <i class="fas fa-search text-gray-400 absolute left-4 top-1/2 -translate-y-1/2 z-10 text-lg"></i>
                            <input type="text" id="searchInput" 
                                   placeholder="e.g., AI founders in San Francisco with machine learning experience" 
                                   class="search-input-glow w-full pl-12 pr-32 py-4 text-base bg-white rounded-xl focus:outline-none">
                            <button id="searchBtn" class="btn-glow absolute right-2 top-1/2 -translate-y-1/2 font-semibold px-6 py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-search mr-2"></i>Search
                            </button>
                        </div>
                        
                        <div class="flex flex-wrap items-center gap-2">
                            <span class="text-sm text-gray-500">Try these:</span>
                            <button class="example-query text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-full">AI founders</button>
                            <button class="example-query text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-full">Software engineers in NYC</button>
                            <button class="example-query text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-full">Marketing managers</button>
                            <button class="example-query text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-full">Product designers in CA</button>
                        </div>
                    </div>
                </section>

                <!-- Loading State -->
                <div id="loadingState" class="hidden modern-card p-8 text-center">
                    <div class="flex flex-col items-center justify-center space-y-4">
                        <div class="relative">
                            <div class="w-16 h-16 rounded-full border-4 border-gray-200 border-t-gray-800 animate-spin"></div>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="fas fa-search text-gray-800 text-xl"></i>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-900 mb-1">AI is searching through profiles<span class="pulse-dots"></span></h3>
                            <p class="text-gray-600 mb-3">Finding the most relevant matches for your query</p>
                            <div class="flex items-center justify-center text-sm text-gray-700">
                                <span class="status-dot status-processing"></span>
                                <span id="searchStatus">Processing your query...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="hidden">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                        <div>
                            <h3 class="text-xl font-bold text-gray-900">Search Results</h3>
                            <p id="resultCount" class="text-gray-600 text-sm mt-1"></p>
                        </div>
                        <div class="flex items-center space-x-4 mt-2 sm:mt-0">
                            <div class="text-xs text-gray-500">
                                <i class="fas fa-info-circle mr-1"></i>
                                Click "View Profile" to visit LinkedIn
                            </div>
                            <button onclick="showAgentFeedback()" class="text-xs text-purple-600 hover:text-purple-800 font-medium">
                                <i class="fas fa-star mr-1"></i>Teach Agent
                            </button>
                        </div>
                    </div>
                    
                    <div id="resultsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                        <!-- Results will be inserted here by JavaScript -->
                    </div>
                    
                    <!-- Pagination will be inserted here by JavaScript -->
                </div>

                <!-- Agent Thinking State -->
                <div id="agentThinkingState" class="hidden modern-card p-8 text-center">
                    <div class="flex flex-col items-center justify-center space-y-4">
                        <div class="relative">
                            <div class="w-20 h-20 rounded-full border-4 border-purple-200 border-t-purple-600 animate-spin"></div>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="fas fa-brain text-purple-600 text-2xl"></i>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-900 mb-1">AI Agent is thinking<span class="pulse-dots"></span></h3>
                            <p class="text-gray-600 mb-3">Reasoning through multiple steps to find optimal matches</p>
                            <div class="flex items-center justify-center text-sm text-gray-700">
                                <div class="typing-indicator"></div>
                                <div class="typing-indicator ml-1"></div>
                                <div class="typing-indicator ml-1"></div>
                                <span id="agentThinkingStatus" class="ml-2">Analyzing intent...</span>
                            </div>
                        </div>
                        <div id="reasoningSteps" class="mt-4 text-left text-sm text-gray-600 max-w-md mx-auto hidden">
                            <h4 class="font-bold text-gray-800 mb-2">Reasoning Steps:</h4>
                            <div class="space-y-1" id="reasoningStepsList">
                                <!-- Steps will appear here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- No Results State -->
                <div id="noResultsState" class="hidden modern-card p-10 text-center">
                    <div class="w-20 h-20 mx-auto mb-6">
                        <div class="relative w-full h-full">
                            <div class="absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full opacity-20"></div>
                            <i class="fas fa-search-minus text-4xl text-gray-400 relative"></i>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">No Results Found</h3>
                    <p class="text-gray-600 mb-4">Try using different keywords or broader search terms</p>
                    <button onclick="targetini.performSearch()" class="btn-glow font-semibold px-6 py-3 rounded-lg mr-2">
                        <i class="fas fa-redo mr-2"></i>Try Again
                    </button>
                    <button onclick="toggleAgentChat()" class="btn-secondary font-semibold px-6 py-3 rounded-lg">
                        <i class="fas fa-robot mr-2"></i>Ask Agent
                    </button>
                </div>

                <!-- Error State -->
                <div id="errorState" class="hidden modern-card p-10 text-center">
                    <div class="w-20 h-20 mx-auto mb-6">
                        <div class="relative w-full h-full">
                            <div class="absolute inset-0 bg-gradient-to-br from-red-100 to-red-200 rounded-full opacity-20"></div>
                            <i class="fas fa-exclamation-triangle text-4xl text-red-500 relative"></i>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Something went wrong</h3>
                    <p id="errorMessage" class="text-gray-600 mb-6"></p>
                    <button id="retryBtn" class="btn-glow font-semibold px-6 py-3 rounded-lg">
                        <i class="fas fa-redo mr-2"></i>Retry Search
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="border-t border-gray-200 mt-12 bg-white">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <img id="footerLogo" src="/static/images/Targetini.png" alt="Targetini Logo" class="h-6 w-auto cursor-pointer">
                        <span class="text-lg font-bold">Target<span class="text-gradient">ini</span></span>
                    </div>
                    <p class="text-sm text-gray-600">
                        Transform your LinkedIn network from overwhelming to organized. Find hidden connections instantly with AI Agents.
                    </p>
                </div>
                
                <div>
                    <h4 class="text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4">Connect</h4>
                    <div class="space-y-3">
                        <a href="https://wa.me/919860428960" target="_blank" rel="noopener noreferrer" class="flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors">
                            <i class="fab fa-whatsapp mr-3 text-green-600"></i>
                            WhatsApp: +91 98604 28960
                        </a>
                        <a href="https://www.linkedin.com/in/shubham-murar/" target="_blank" rel="noopener noreferrer" class="flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors">
                            <i class="fab fa-linkedin mr-3 text-blue-600"></i>
                            LinkedIn: Shubham Murar
                        </a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4">AI Agents</h4>
                    <ul class="space-y-2 text-sm text-gray-600">
                        <li class="flex items-center">
                            <i class="fas fa-robot mr-2 text-purple-600"></i>
                            Conversational Agent
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-graduation-cap mr-2 text-blue-600"></i>
                            Learning Agent
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-brain mr-2 text-gray-700"></i>
                            LangGraph Orchestration
                        </li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4">Technology</h4>
                    <ul class="space-y-2 text-sm text-gray-600">
                        <li class="flex items-center">
                            <i class="fas fa-code mr-2 text-gray-700"></i>
                            LangChain + LangGraph
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-database mr-2 text-gray-700"></i>
                            Qdrant Vector DB
                        </li>
                        <li class="flex items-center">
                            <i class="fab fa-google mr-2 text-gray-700"></i>
                            Gemini AI
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-8 pt-8 border-t border-gray-200 flex flex-col sm:flex-row items-center justify-between text-sm">
                <p class="text-gray-500 order-2 sm:order-1 mt-4 sm:mt-0">
                    Â© 2025 Targetini. Crafted by <a href="https://www.linkedin.com/in/shubham-murar/" target="_blank" rel="noopener noreferrer" class="text-gray-700 font-medium hover:text-gray-900">Shubham Murar</a>
                </p>
                <div class="flex space-x-6 order-1 sm:order-2">
                    <button onclick="checkSystemHealth()" class="text-gray-400 hover:text-gray-700 transition-colors">
                        <i class="fas fa-heartbeat text-lg"></i>
                    </button>
                    <a href="https://www.linkedin.com/in/shubham-murar/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-gray-700 transition-colors">
                        <i class="fab fa-linkedin text-lg"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Agent Feedback Modal -->
    <div id="agentFeedbackModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4 modern-card">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold text-gray-900">
                    <i class="fas fa-graduation-cap text-purple-600 mr-2"></i>
                    Teach the AI Agent
                </h3>
                <button onclick="closeFeedbackModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="text-gray-600 text-sm mb-4">Help the agent learn your preferences by providing feedback on search results.</p>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">What did you like?</label>
                    <textarea id="positiveFeedback" placeholder="E.g., I liked candidates from San Francisco with startup experience..." class="search-input-glow w-full px-3 py-2 text-sm rounded-lg focus:outline-none" rows="2"></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">What didn't you like?</label>
                    <textarea id="negativeFeedback" placeholder="E.g., Avoid candidates from large corporations..." class="search-input-glow w-full px-3 py-2 text-sm rounded-lg focus:outline-none" rows="2"></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">General preferences</label>
                    <div class="flex flex-wrap gap-2">
                        <button class="preference-tag text-xs px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors">Remote work</button>
                        <button class="preference-tag text-xs px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors">Startup experience</button>
                        <button class="preference-tag text-xs px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors">Senior level</button>
                        <button class="preference-tag text-xs px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors">Tech industry</button>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 flex justify-end space-x-3">
                <button onclick="closeFeedbackModal()" class="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900">
                    Cancel
                </button>
                <button onclick="submitFeedbackToAgent()" class="btn-glow px-4 py-2 text-sm font-medium">
                    <i class="fas fa-brain mr-2"></i>Teach Agent
                </button>
            </div>
        </div>
    </div>

    <script>
        class Targetini {
            constructor() {
                // Existing elements
                this.searchInput = document.getElementById('searchInput');
                this.searchBtn = document.getElementById('searchBtn');
                this.loadingState = document.getElementById('loadingState');
                this.resultsSection = document.getElementById('resultsSection');
                this.resultsContainer = document.getElementById('resultsContainer');
                this.resultCount = document.getElementById('resultCount');
                this.noResultsState = document.getElementById('noResultsState');
                this.errorState = document.getElementById('errorState');
                this.errorMessage = document.getElementById('errorMessage');
                this.retryBtn = document.getElementById('retryBtn');
                this.searchStatus = document.getElementById('searchStatus');
                this.exampleQueries = document.querySelectorAll('.example-query');
                
                // New AI Agent elements
                this.agentStatusCard = document.getElementById('agentStatusCard');
                this.agentChatSection = document.getElementById('agentChatSection');
                this.mainSearchSection = document.getElementById('mainSearchSection');
                this.agentThinkingState = document.getElementById('agentThinkingState');
                this.agentThinkingStatus = document.getElementById('agentThinkingStatus');
                this.reasoningSteps = document.getElementById('reasoningSteps');
                this.reasoningStepsList = document.getElementById('reasoningStepsList');
                this.agentInput = document.getElementById('agentInput');
                this.agentSendBtn = document.getElementById('agentSendBtn');
                this.agentChatMessages = document.getElementById('agentChatMessages');
                this.agentDetails = document.getElementById('agentDetails');
                this.chatWithAgentBtn = document.getElementById('chatWithAgentBtn');
                this.tryAdaptiveSearchBtn = document.getElementById('tryAdaptiveSearchBtn');
                this.agentExampleQueries = document.querySelectorAll('.agent-example-query');

                // Data storage
                this.allResults = [];
                this.currentPage = 1;
                this.pageSize = 12;
                this.currentQuery = '';
                this.currentSearchId = null;
                this.agentActive = false;
                this.agentMessages = [];
                this.userPreferences = {};

                this.bindEvents();
                this.checkAgentStatus();
            }

            bindEvents() {
                // Existing events
                this.searchBtn.addEventListener('click', () => this.performSearch());
                this.searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.performSearch();
                });

                this.exampleQueries.forEach(query => {
                    query.addEventListener('click', () => {
                        this.searchInput.value = query.textContent;
                        this.performSearch();
                    });
                });

                this.retryBtn.addEventListener('click', () => this.performSearch());
                
                // Logo click events
                const logo = document.getElementById('logo');
                const footerLogo = document.getElementById('footerLogo');
                
                if (logo) {
                    logo.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showLogoMessage();
                    });
                }
                
                if (footerLogo) {
                    footerLogo.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showLogoMessage();
                    });
                }
                
                // New AI Agent events
                this.chatWithAgentBtn.addEventListener('click', () => this.toggleAgentChat());
                this.tryAdaptiveSearchBtn.addEventListener('click', () => this.tryAdaptiveSearch());
                this.agentSendBtn.addEventListener('click', () => this.sendAgentMessage());
                this.agentInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendAgentMessage();
                });
                
                this.agentExampleQueries.forEach(query => {
                    query.addEventListener('click', (e) => {
                        const text = e.target.textContent.replace(/[ðŸ¤–âœ¨â˜…]/g, '').trim();
                        this.agentInput.value = text;
                        this.sendAgentMessage();
                    });
                });
                
                // Initialize with a welcome message
                this.addAgentMessage("Hi! I'm your AI Recruiting Agent powered by LangGraph. How can I help you find professionals today?", 'agent');
            }
            
            showLogoMessage() {
                const message = document.createElement('div');
                message.id = 'logoMessage';
                message.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 z-50';
                message.innerHTML = `
                    <div class="bg-red-100 border-l-4 border-red-500 text-red-700 px-6 py-4 rounded-lg shadow-lg animate-fade-in-up">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-triangle mr-3 text-lg"></i>
                            <div>
                                <p class="font-bold">Why are you trying to reload me!</p>
                                <p class="text-sm">Just refresh the page!!</p>
                            </div>
                            <button onclick="document.getElementById('logoMessage').remove()" class="ml-6 text-red-500 hover:text-red-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                if (!document.getElementById('logoMessageStyle')) {
                    const style = document.createElement('style');
                    style.id = 'logoMessageStyle';
                    style.textContent = `
                        @keyframes fadeInUp {
                            from {
                                opacity: 0;
                                transform: translate(-50%, -20px);
                            }
                            to {
                                opacity: 1;
                                transform: translate(-50%, 0);
                            }
                        }
                        .animate-fade-in-up {
                            animation: fadeInUp 0.3s ease-out;
                        }
                    `;
                    document.head.appendChild(style);
                }
                
                const existingMessage = document.getElementById('logoMessage');
                if (existingMessage) {
                    existingMessage.remove();
                }
                
                document.body.appendChild(message);
                
                setTimeout(() => {
                    if (document.getElementById('logoMessage')) {
                        document.getElementById('logoMessage').remove();
                    }
                }, 5000);
            }

            async performSearch() {
                const query = this.searchInput.value.trim();
                if (!query) {
                    this.showNotification('Please enter a search query', 'warning');
                    return;
                }

                this.currentQuery = query;
                this.currentPage = 1;
                
                this.hideAllStates();
                this.loadingState.classList.remove('hidden');
                this.searchStatus.textContent = 'Processing your query...';
                this.searchBtn.disabled = true;

                try {
                    const startResponse = await fetch('/api/search', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query: query })
                    });

                    const startData = await startResponse.json();

                    if (!startData.success) {
                        throw new Error(startData.error || 'Failed to start search');
                    }

                    this.currentSearchId = startData.search_id;
                    this.searchStatus.textContent = 'Analyzing search intent...';
                    
                    await this.pollForResults();

                } catch (error) {
                    console.error('Search error:', error);
                    this.hideAllStates();
                    this.errorMessage.textContent = error.message || 'Network error occurred';
                    this.errorState.classList.remove('hidden');
                    this.searchBtn.disabled = false;
                }
            }

            async pollForResults(maxAttempts = 60) {
                let attempts = 0;
                
                const poll = async () => {
                    try {
                        const response = await fetch(`/api/search/${this.currentSearchId}`);
                        const data = await response.json();

                        if (!data.success) {
                            throw new Error(data.error || 'Search failed');
                        }

                        switch (data.status) {
                            case 'queued':
                                this.searchStatus.textContent = 'Queued for processing...';
                                break;
                            case 'processing':
                                this.searchStatus.textContent = 'Searching through profiles...';
                                break;
                            case 'completed':
                                this.searchStatus.textContent = 'Finalizing results...';
                                setTimeout(() => {
                                    this.processResults(data.results);
                                    this.searchBtn.disabled = false;
                                }, 500);
                                return;
                            case 'error':
                                throw new Error(data.error || 'Search failed');
                        }

                        attempts++;
                        if (attempts >= maxAttempts) {
                            throw new Error('Search timeout - taking too long');
                        }

                        setTimeout(poll, 2000);

                    } catch (error) {
                        this.handleError(error);
                        this.searchBtn.disabled = false;
                    }
                };

                poll();
            }

            processResults(results) {
                this.hideAllStates();

                if (results && results.length > 0) {
                    this.allResults = results;
                    this.renderPage(1);
                    this.resultsSection.classList.remove('hidden');
                    this.showNotification(`Found ${results.length} professionals`, 'success');
                } else {
                    this.noResultsState.classList.remove('hidden');
                }
            }

            handleError(error) {
                console.error('Search error:', error);
                this.hideAllStates();
                this.errorMessage.textContent = error.message || 'An unexpected error occurred';
                this.errorState.classList.remove('hidden');
                this.showNotification('Search failed. Please try again.', 'error');
            }

            hideAllStates() {
                this.loadingState.classList.add('hidden');
                this.resultsSection.classList.add('hidden');
                this.noResultsState.classList.add('hidden');
                this.errorState.classList.add('hidden');
                this.agentThinkingState.classList.add('hidden');
                this.searchStatus.textContent = '';
                this.reasoningSteps.classList.add('hidden');
            }

            renderPage(page) {
                this.currentPage = page;
                const totalResults = this.allResults.length;
                const totalPages = Math.ceil(totalResults / this.pageSize);
                const startIndex = (page - 1) * this.pageSize;
                const endIndex = Math.min(startIndex + this.pageSize, totalResults);
                const pageResults = this.allResults.slice(startIndex, endIndex);

                this.resultCount.textContent = `Showing ${startIndex + 1}-${endIndex} of ${totalResults} professionals for "${this.currentQuery}"`;

                this.resultsContainer.innerHTML = pageResults.map((person, index) => `
                    <div class="modern-card p-5 flex flex-col justify-between h-full">
                        <div>
                            <div class="flex items-start justify-between mb-3">
                                <div class="flex-1">
                                    <h4 class="text-lg font-bold text-gray-900 mb-1">${person.name || 'N/A'}</h4>
                                    <p class="text-gray-700 font-semibold text-sm">${person.current_position || 'N/A'}</p>
                                </div>
                                <div class="flex space-x-1">
                                    <button onclick="targetini.giveFeedback(${startIndex + index}, 'like')" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-green-500 transition-colors" title="Like this result">
                                        <i class="fas fa-thumbs-up"></i>
                                    </button>
                                    <button onclick="targetini.giveFeedback(${startIndex + index}, 'dislike')" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-red-500 transition-colors" title="Dislike this result">
                                        <i class="fas fa-thumbs-down"></i>
                                    </button>
                                </div>
                            </div>
                            
                            ${person.match_reason ? `
                                <div class="mb-4">
                                    <span class="match-badge">${person.match_reason}</span>
                                </div>
                            ` : ''}
                            
                            <div class="space-y-3 mb-4 text-sm text-gray-600 border-t border-gray-100 pt-4">
                                <div class="flex items-center">
                                    <i class="fas fa-building w-5 text-center mr-3 text-gray-500"></i>
                                    <span class="truncate">${person.current_company || 'N/A'}</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt w-5 text-center mr-3 text-gray-500"></i>
                                    <span>${person.location || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                        ${person.linkedin ? `
                            <a href="${person.linkedin}" target="_blank" rel="noopener noreferrer" 
                               class="btn-glow flex items-center justify-center w-full font-semibold py-3 px-4 rounded-lg text-sm mt-4 group">
                                <i class="fab fa-linkedin-in mr-2 group-hover:scale-110 transition-transform"></i>
                                View Profile
                            </a>
                        ` : `
                            <div class="mt-4 text-center py-3 text-gray-500 text-sm bg-gray-50 rounded-lg border border-gray-100">
                                Profile not available
                            </div>
                        `}
                    </div>
                `).join('');

                this.renderPaginationControls(totalPages);
            }

            renderPaginationControls(totalPages) {
                const existingPagination = document.getElementById('paginationControls');
                if (existingPagination) {
                    existingPagination.remove();
                }

                if (totalPages <= 1) return;

                const paginationHTML = `
                    <div id="paginationControls" class="flex justify-center items-center space-x-2 mt-8">
                        <button ${this.currentPage === 1 ? 'disabled' : ''} 
                            class="pagination-btn px-4 py-2.5 bg-white rounded-lg ${this.currentPage > 1 ? 'hover:bg-gray-50' : 'opacity-50 cursor-not-allowed'}" 
                            onclick="targetini.goToPage(${this.currentPage - 1})">
                            <i class="fas fa-chevron-left mr-2"></i> Previous
                        </button>
                        
                        ${this.generatePageNumbers(this.currentPage, totalPages)}
                        
                        <button ${this.currentPage === totalPages ? 'disabled' : ''} 
                            class="pagination-btn px-4 py-2.5 bg-white rounded-lg ${this.currentPage < totalPages ? 'hover:bg-gray-50' : 'opacity-50 cursor-not-allowed'}" 
                            onclick="targetini.goToPage(${this.currentPage + 1})">
                            Next <i class="fas fa-chevron-right ml-2"></i>
                        </button>
                    </div>
                `;
                
                this.resultsContainer.insertAdjacentHTML('afterend', paginationHTML);
            }

            generatePageNumbers(currentPage, totalPages) {
                let pages = [];
                const maxVisible = 5;
                
                let start = Math.max(1, currentPage - Math.floor(maxVisible / 2));
                let end = Math.min(totalPages, start + maxVisible - 1);
                
                if (end - start + 1 < maxVisible) {
                    start = Math.max(1, end - maxVisible + 1);
                }
                
                if (start > 1) {
                    pages.push(`
                        <button class="pagination-btn px-3.5 py-2.5 bg-white rounded-lg hover:bg-gray-50" 
                            onclick="targetini.goToPage(1)">
                            1
                        </button>
                    `);
                    if (start > 2) {
                        pages.push('<span class="px-2 text-gray-400">...</span>');
                    }
                }
                
                for (let i = start; i <= end; i++) {
                    pages.push(`
                        <button class="px-3.5 py-2.5 rounded-lg ${i === currentPage ? 'btn-glow text-white' : 'bg-white hover:bg-gray-50'}" 
                            onclick="targetini.goToPage(${i})">
                            ${i}
                        </button>
                    `);
                }
                
                if (end < totalPages) {
                    if (end < totalPages - 1) {
                        pages.push('<span class="px-2 text-gray-400">...</span>');
                    }
                    pages.push(`
                        <button class="pagination-btn px-3.5 py-2.5 bg-white rounded-lg hover:bg-gray-50" 
                            onclick="targetini.goToPage(${totalPages})">
                            ${totalPages}
                        </button>
                    `);
                }
                
                return pages.join('');
            }

            goToPage(page) {
                if (page < 1 || page > Math.ceil(this.allResults.length / this.pageSize)) return;
                this.renderPage(page);
                
                this.resultsSection.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }

            // AI Agent Methods
            toggleAgentChat() {
                if (this.agentChatSection.classList.contains('hidden')) {
                    this.agentChatSection.classList.remove('hidden');
                    this.mainSearchSection.classList.add('hidden');
                    setTimeout(() => {
                        this.agentInput.focus();
                    }, 100);
                } else {
                    this.agentChatSection.classList.add('hidden');
                    this.mainSearchSection.classList.remove('hidden');
                }
            }

            async tryAdaptiveSearch() {
                const query = this.searchInput.value.trim();
                if (!query) {
                    this.showNotification('Please enter a search query first', 'warning');
                    return;
                }
                
                this.hideAllStates();
                this.agentThinkingState.classList.remove('hidden');
                this.agentThinkingStatus.textContent = 'Using adaptive learning agent...';
                
                try {
                    const response = await fetch('/api/agent/adaptive-search', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            query: query,
                            user_id: 'default'
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        this.agentThinkingStatus.textContent = 'Personalizing results based on learned preferences...';
                        
                        setTimeout(() => {
                            this.agentThinkingState.classList.add('hidden');
                            if (data.results && data.results.length > 0) {
                                this.allResults = data.results;
                                this.currentQuery = query;
                                this.renderPage(1);
                                this.resultsSection.classList.remove('hidden');
                                
                                // Show agent explanation
                                this.addAgentMessage(data.explanation, 'agent');
                                this.toggleAgentChat();
                                
                                this.showNotification(`Adaptive search found ${data.results.length} personalized results`, 'success');
                            } else {
                                this.noResultsState.classList.remove('hidden');
                            }
                        }, 1500);
                    } else {
                        throw new Error(data.error || 'Adaptive search failed');
                    }
                } catch (error) {
                    console.error('Adaptive search error:', error);
                    this.agentThinkingState.classList.add('hidden');
                    this.errorMessage.textContent = error.message;
                    this.errorState.classList.remove('hidden');
                }
            }

            async sendAgentMessage() {
                const message = this.agentInput.value.trim();
                if (!message) return;
                
                // Add user message
                this.addAgentMessage(message, 'user');
                this.agentInput.value = '';
                
                // Show thinking state
                this.agentThinkingState.classList.remove('hidden');
                this.reasoningSteps.classList.remove('hidden');
                this.agentThinkingStatus.textContent = 'Analyzing your request...';
                
                // Simulate reasoning steps
                this.showReasoningSteps();
                
                try {
                    const response = await fetch('/api/agent/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            message: message,
                            user_id: 'default'
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        // Hide thinking state
                        setTimeout(() => {
                            this.agentThinkingState.classList.add('hidden');
                            
                            // Add agent response
                            this.addAgentMessage(data.response, 'agent');
                            
                            // Show reasoning steps if available
                            if (data.reasoning_steps && data.reasoning_steps.length > 0) {
                                this.showReasoningSteps(data.reasoning_steps);
                            }
                            
                            // If the agent suggests a search, automatically trigger it
                            if (data.response.toLowerCase().includes('found') || data.response.toLowerCase().includes('search')) {
                                // Extract potential search query from response
                                const searchMatch = data.response.match(/["']([^"']+)["']/);
                                if (searchMatch) {
                                    setTimeout(() => {
                                        this.searchInput.value = searchMatch[1];
                                        this.performSearch();
                                        this.toggleAgentChat();
                                    }, 1000);
                                }
                            }
                        }, 1500);
                    } else {
                        throw new Error(data.error || 'Agent chat failed');
                    }
                } catch (error) {
                    console.error('Agent chat error:', error);
                    this.agentThinkingState.classList.add('hidden');
                    this.addAgentMessage("I'm having trouble connecting to my brain right now. Please try again.", 'agent');
                }
            }

            addAgentMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `flex items-start space-x-3 agent-message ${sender === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`;
                
                const avatar = sender === 'user' ? 
                    `<div class="flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-gray-700 to-gray-900 flex items-center justify-center">
                        <i class="fas fa-user text-white text-sm"></i>
                    </div>` :
                    `<div class="flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 flex items-center justify-center">
                        <i class="fas fa-robot text-white text-sm"></i>
                    </div>`;
                
                const messageClass = sender === 'user' ? 
                    'bg-gradient-to-r from-gray-900 to-gray-700 text-white' : 
                    'bg-white border border-gray-200';
                
                messageDiv.innerHTML = `
                    ${avatar}
                    <div class="${messageClass} p-4 rounded-xl flex-1 max-w-[80%]">
                        <p class="${sender === 'user' ? 'text-white' : 'text-gray-700'}">${this.escapeHtml(text)}</p>
                        ${sender === 'agent' && text.includes('Step') ? `
                            <div class="mt-2 pt-2 border-t border-gray-100">
                                <p class="text-xs text-gray-500"><i class="fas fa-brain mr-1"></i> Agent Reasoning</p>
                            </div>
                        ` : ''}
                    </div>
                `;
                
                this.agentChatMessages.appendChild(messageDiv);
                this.agentChatMessages.scrollTop = this.agentChatMessages.scrollHeight;
                
                // Store message
                this.agentMessages.push({ text, sender, timestamp: new Date() });
            }

            showReasoningSteps(steps = null) {
                this.reasoningStepsList.innerHTML = '';
                
                if (steps) {
                    steps.forEach((step, index) => {
                        const stepDiv = document.createElement('div');
                        stepDiv.className = 'reasoning-step';
                        stepDiv.innerHTML = `
                            <span class="text-gray-500 text-xs">Step ${index + 1}:</span>
                            <span class="text-gray-700 text-sm ml-1">${step}</span>
                        `;
                        this.reasoningStepsList.appendChild(stepDiv);
                    });
                } else {
                    // Default steps for demonstration
                    const defaultSteps = [
                        'Understanding your search intent',
                        'Expanding query with synonyms',
                        'Searching vector database',
                        'Filtering based on relevance',
                        'Formatting results'
                    ];
                    
                    defaultSteps.forEach((step, index) => {
                        const stepDiv = document.createElement('div');
                        stepDiv.className = 'reasoning-step';
                        stepDiv.innerHTML = `
                            <span class="text-gray-500 text-xs">Step ${index + 1}:</span>
                            <span class="text-gray-700 text-sm ml-1">${step}</span>
                        `;
                        this.reasoningStepsList.appendChild(stepDiv);
                    });
                }
                
                this.reasoningSteps.classList.remove('hidden');
            }

            async checkAgentStatus() {
                try {
                    const response = await fetch('/api/agent/status');
                    const data = await response.json();
                    
                    if (data.success || data.agents_available) {
                        this.agentActive = true;
                        document.getElementById('agentStatusBadge').classList.remove('hidden');
                        
                        // Update agent details
                        this.agentDetails.innerHTML = data.agents_available.map(agent => `
                            <div class="bg-gray-50 p-3 rounded-lg border border-gray-100">
                                <div class="flex items-center space-x-2 mb-2">
                                    <i class="fas fa-${agent.type === 'langchain_agent' ? 'comments' : 'graduation-cap'} ${agent.type === 'langchain_agent' ? 'text-purple-600' : 'text-blue-600'}"></i>
                                    <span class="font-medium text-gray-900 text-sm">${agent.name}</span>
                                </div>
                                <div class="text-xs text-gray-600">
                                    <div class="flex items-center">
                                        <i class="fas fa-check-circle text-green-500 mr-1"></i>
                                        ${agent.capabilities.slice(0, 2).join(', ')}
                                    </div>
                                    ${agent.learned_users ? `
                                        <div class="flex items-center mt-1">
                                            <i class="fas fa-users text-blue-500 mr-1"></i>
                                            Learned from ${agent.learned_users} users
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('');
                    }
                } catch (error) {
                    console.log('Agent status check failed, agents may not be initialized');
                    this.agentActive = false;
                }
            }

            giveFeedback(index, type) {
                const person = this.allResults[index];
                if (!person) return;
                
                const feedback = {
                    liked: type === 'like' ? [person] : [],
                    disliked: type === 'dislike' ? [person] : [],
                    text_feedback: `${type === 'like' ? 'Liked' : 'Disliked'} candidate: ${person.name} - ${person.current_position} at ${person.current_company}`
                };
                
                this.submitAgentFeedback(feedback);
                
                this.showNotification(
                    type === 'like' ? 'Thanks! Agent will look for similar profiles.' : 'Noted! Agent will avoid similar profiles.',
                    'info'
                );
            }

            async submitAgentFeedback(feedback) {
                try {
                    const response = await fetch('/api/agent/learn', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            feedback: feedback,
                            user_id: 'default'
                        })
                    });
                    
                    const data = await response.json();
                    if (data.success) {
                        console.log('Agent learned from feedback:', data.message);
                    }
                } catch (error) {
                    console.error('Failed to submit feedback:', error);
                }
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 px-4 py-3 rounded-lg shadow-lg z-50 ${type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' : type === 'error' ? 'bg-red-100 text-red-800 border border-red-200' : 'bg-blue-100 text-blue-800 border border-blue-200'}`;
                notification.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.transition = 'opacity 0.3s';
                    notification.style.opacity = '0';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        }

        // Global instance
        let targetini;

        // Helper functions for global access
        function toggleAgentChat() {
            targetini.toggleAgentChat();
        }

        function checkAgentStatus() {
            targetini.checkAgentStatus();
        }

        function showAgentFeedback() {
            document.getElementById('agentFeedbackModal').classList.remove('hidden');
        }

        function closeFeedbackModal() {
            document.getElementById('agentFeedbackModal').classList.add('hidden');
        }

        function submitFeedbackToAgent() {
            const positive = document.getElementById('positiveFeedback').value;
            const negative = document.getElementById('negativeFeedback').value;
            
            const feedback = {
                liked: [],
                disliked: [],
                text_feedback: `Positive: ${positive}. Negative: ${negative}`
            };
            
            targetini.submitAgentFeedback(feedback);
            closeFeedbackModal();
            targetini.showNotification('Agent learned from your feedback!', 'success');
        }

        function checkSystemHealth() {
            fetch('/health')
                .then(response => response.json())
                .then(data => {
                    const message = `System Status: ${data.status}\nActive Searches: ${data.active_searches}\nAI Agents: ${data.ai_agents ? 'Active' : 'Inactive'}\nFeatures: ${Object.keys(data.features || {}).filter(k => data.features[k]).join(', ')}`;
                    targetini.showNotification(message, 'info');
                })
                .catch(() => {
                    targetini.showNotification('Could not check system health', 'error');
                });
        }

        document.addEventListener('DOMContentLoaded', () => {
            targetini = new Targetini();
            
            // Focus search input on load
            setTimeout(() => {
                document.getElementById('searchInput').focus();
            }, 100);
            
            // Check agent status after a delay
            setTimeout(() => {
                targetini.checkAgentStatus();
            }, 2000);
        });
    </script>

</body>
</html>



